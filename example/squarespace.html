<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<style>
			section {border-bottom: 1px solid grey; padding: 0.5em 1em 0.5em 1em; margin: 1em 0 0 0;}
			header {margin: 0 -1em 0 -1em;}
		</style>
	</head>
	<body>
		<section>
			<header><strong>delimiters and translations as single text node</strong></header>
			....Who We Are..Qui nous sommes..Quiénes somos....
		</section>
		
		<section>
			<header><strong>delimiters and translations as single text node, whitespace noise</strong></header>
			.... Who We Are .. Qui nous sommes .. Quiénes somos ....
		</section>
		
		<section>
			<header><strong>delimiters and translations as single text node inside an immediate element</strong></header>
			<div>
				....Who We Are..Qui nous sommes..Quiénes somos....
			</div>
		</section>
		
		<section>
			<header><strong>delimiters and translations as single text node inside a deeply nested element</strong></header>
			<div><div><div>
				....Who We Are..Qui nous sommes..Quiénes somos....
			</div></div></div>
		</section>
		
		<section>
			<header><strong>translations in elements separated by delimiters</strong></header>
			....
			<div>Who We Are</div>
			..
			<div>Qui nous sommes</div>
			..
			<div>Quiénes somos</div>
			....
		</section>
		
		<section>
			<header><strong>translations in elements separated by delimiters, all contained in element</strong></header>
			<div>
				....
			<div>Who We Are</div>
			..
			<div>Qui nous sommes</div>
			..
			<div>Quiénes somos</div>
			....
			</div>
		</section>
		
		<section>
			<header><strong>translations in elements separated by delimiters, all contained in a deeply nested element</strong></header>
			<div><div><div>
				....
			<div>Who We Are</div>
			..
			<div>Qui nous sommes</div>
			..
			<div>Quiénes somos</div>
			....
			</div></div></div>
		</section>
		
		<section>
			<header><strong>delimited and translations are all in their own elements</strong></header>
			<div>....</div>
			<div>Who We Are</div>
			<div>..</div>
			<div>Qui nous sommes</div>
			<div>..</div>
			<div>Quiénes somos</div>
			<div>....</div>
		</section>
		
		<section>
			<header><strong>delimited and translations are all in their own elements, deeply nested</strong></header>
			<div><div><div>
				<div>....</div>
				<div>Who We Are</div>
				<div>..</div>
				<div>Qui nous sommes</div>
				<div>..</div>
				<div>Quiénes somos</div>
				<div>....</div>
			</div></div></div>
		</section>
		
		<section>
			<header><strong>delimiters and translations in an element attribute</strong></header>
			<input type="text" value="....Who We Are..Qui nous sommes..Quiénes somos....">
		</section>
		
		<script>
			var langCodeList = ["en", "fr", "es"];
			// multitongue 0.1.1
			var Multitongue=function(e,t){"use strict";"number"==typeof e?this.langIndex=e:(t=e,this.langIndex=t&&t.langIndex||null),this.delimiterMap={groupStart:t&&t.groupStart||"....",languageSeparator:t&&t.languageSeparator||"..",groupEnd:t&&t.groupEnd||"...."},this.filterAttribute=function(e){for(var t=[],r=0;;){var i=e.indexOf(this.delimiterMap.groupStart,r);if(-1===i)break;var a=i+this.delimiterMap.groupStart.length,n=e.indexOf(this.delimiterMap.groupEnd,a);if(-1===n)break;var d=n+this.delimiterMap.groupEnd.length,l=e.substring(a,n).split(this.delimiterMap.languageSeparator);t.push(e.substring(r,i)),t.push(l["undefined"==typeof l[this.langIndex]?0:this.langIndex]),r=d}return 0===t.length?null:(t.push(e.substring(r)),t.join(""))},this.nodeFilter=function(e,t){for(var r=[],i=0,a=e.childNodes;;){var n=t(a,this.delimiterMap.groupStart,i);if(-1===n)break;var d=t(a,this.delimiterMap.groupEnd,n+1);if(-1===d)break;var l=t(a,this.delimiterMap.languageSeparator,n+1,d-1,this.langIndex);-1===l&&(l=n);for(var o=n;l+1>o;o++)r.push(a[o]);var h=t(a,this.delimiterMap.languageSeparator,l+1,d-1);-1===h&&(h=d);for(var o=h;d+1>o;o++)r.push(a[o]);i=d+1}return r},this.childNodeIndexOf=function(e,t,r,i,a){var n=-1;"undefined"==typeof i&&(i=e.length),a="undefined"==typeof a?1:a;for(var d=r||0,l=0;d<e.length&&i>d&&a>l;d++)if(e[d].nodeType===Node.ELEMENT_NODE&&1===e[d].childNodes.length){var o=e[d].firstChild;o&&o.nodeType===Node.TEXT_NODE&&o.data.trim()===t&&(l++,n=d)}return n},this.nodeIndexOf=function(e,t,r,i,a){var n=-1;"undefined"==typeof i&&(i=e.length),a="undefined"==typeof a?1:a;for(var d=r||0,l=0;d<e.length&&i>d&&a>l;d++)e[d].nodeType===Node.TEXT_NODE&&e[d].data===t&&(l++,n=d);return n},this.reduce=function(e){if(e.nodeType||"undefined"==typeof e.length){if(-1!==e.outerHTML.indexOf(this.delimiterMap.groupStart)){for(var t=0;t<e.attributes.length;t++){var r=this.filterAttribute(e.attributes[t].value);null!==r&&(e.attributes[t].value=r)}for(var i=this.nodeFilter(e,this.childNodeIndexOf),t=0;t<i.length;t++)e.removeChild(i[t]);for(var a=e.childNodes,n=[this.delimiterMap.groupStart,this.delimiterMap.groupEnd,this.delimiterMap.languageSeparator],t=0;t<a.length;t++){var d=a[t];if(d.nodeType===Node.TEXT_NODE)for(;;){for(var l=d.data.length,o=0,h=0;h<n.length;h++){var u=d.data.indexOf(n[h]);-1!==u&&l>u&&(o=n[h].length,l=u)}if(l===d.data.length||o===d.data.length)break;0!==l&&(d=d.splitText(l),t++),d=d.splitText(o),t++}}for(var s=this.nodeFilter(e,this.nodeIndexOf),t=0;t<s.length;t++)e.removeChild(s[t]);for(var a=e.childNodes,t=0;t<a.length;t++){var d=a[t];d.nodeType===Node.ELEMENT_NODE&&this.reduce(d)}}}else for(var t=0;t<e.length;t++)this.reduce(e[t])}};
			Multitongue.element=function(t){"use strict";for(var e=t.split(","),n=[],u=0;u<e.length;u++)n.push(document.getElementsByTagName(e[u].trim()));return n};
			Multitongue.LanguageIndex=function(e,t){"use strict";this.codeList=e,this.getQueryCode=function(){var e=location.search.match(/[\?&]lang=([^&#]*)/);return e=decodeURIComponent(e&&e[1]||""),-1!==this.codeList.indexOf(e)&&e||null},this.getCookieCode=function(){var e=document.cookie.replace(/(?:(?:^|.*;\s*)langCode\s*\=\s*([^;]*).*$)|^.*$/,"$1");return-1===this.codeList.indexOf(e)?null:e},this.setCookie=function(e){if("number"==typeof e&&(e=this.codeList[e]),-1===this.codeList.indexOf(e))throw new Error("invalid value for param langIndexOrCode");document.cookie="langCode="+e},this.getHashCode=function(){var e=window.location.hash.substr(1);return-1===this.codeList.indexOf(e)?null:e},this.getBrowserCode=function(e){for(var t=[].concat([window.navigator.userLanguage]).concat(window.navigator.languages).filter(function(e){return e}).map(function(t){return e?t:t.substr(0,2)}),n=this.codeList.map(function(t){return e?t:t.substr(0,2)}),o=null,i=t.length,s=0;s<n.length;s++){var r=t.indexOf(n[s]);-1!==r&&i>r&&(i=r,o=this.codeList[s])}return o},this.getLangCode=function(){return this.getQueryCode()||this.getHashCode()||this.getCookieCode()||this.getBrowserCode(!0)||this.getBrowserCode(!1)},this.getLangIndex=function(e,t){"undefined"==typeof e&&(e=this.getLangCode()),"undefined"==typeof t&&(t=0);var n=this.codeList.indexOf(e);return-1===n?t:n}};
			// do not translate Squarespace preview uses an iframe, unfortunately other iframe uses also wont render
			var Mt = Multitongue;
			var mtl = new Mt.LanguageIndex(langCodeList);
			var langIndex = mtl.getLangIndex();
			mtl.setCookie(langIndex);
			if (window.location === window.top.location) {
				(new Mt(langIndex)).reduce(Mt.element("body, title"));
			}
		</script>
	</body>
</html>
